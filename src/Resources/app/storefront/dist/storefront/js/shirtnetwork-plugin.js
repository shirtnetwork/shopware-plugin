(window.webpackJsonp=window.webpackJsonp||[]).push([["shirtnetwork-plugin"],{xwCF:function(e,t,n){"use strict";n.r(t);var r=n("FGIj"),i=n("2Jwc"),o=n("k8s9"),a=n("3xtq");function s(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,u,"next",e)}function u(e){s(o,r,i,a,u,"throw",e)}a(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=new o.a;var n=this.client._createPreparedRequest.bind(this.client);this.client._createPreparedRequest=function(e,r,i){var o=n(e,r,i);return o.setRequestHeader("sw-access-key",t),o}}var t,n,r,i,a;return t=e,(n=[{key:"post",value:(a=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toPromise(this.client.post(t,n,this.callback));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"get",value:(i=u(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toPromise(this.client.get(t,this.callback)));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"toPromise",value:function(e){return new Promise((function(t,n){e.onreadystatechange=function(){4===e.readyState&&(e.status>=200&&e.status<300?t(e.responseText):n({status:e.status,statusText:e.statusText}))}}))}},{key:"callback",value:function(){}}])&&c(t.prototype,n),r&&c(t,r),e}(),f=function(e){return new Promise((function(t,n){var r=document.createElement("script");r.src=e,r.async=!0,r.onerror=n,r.onload=r.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,t())},document.head.appendChild(r)}))};function p(e,t){if(null==e)return t;for(var n in t)t[n].constructor===Object?e[n]=p(e[n],t[n]):void 0===e[n]&&(e[n]=t[n]);return e}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){v(o,r,i,a,s,"next",e)}function s(e){v(o,r,i,a,s,"throw",e)}a(void 0)}))}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S,x,P,O=function(e){function t(){return m(this,t),g(this,w(t).apply(this,arguments))}var n,r,s,u,c,h,v,S,x,P;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){var e=this;a.a.create(),this._httpClient=new o.a,this.client=new l(this.options.swAccessKey),this.cartItems=[],this.cache={},this.skuScheme=this.options.skuScheme||"{PRODUCT_SKU}-{VARIANT_SKU}-{SIZE_SKU}",this.pages=this.options.pages||{},f("//cdn.shirtnetwork.de/client/shirtnetwork-client.js").then((function(){return e.boot()}))}},{key:"boot",value:(P=y(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p(this.options,{settings:{container:this.el.id,shop:{cart:{link:window.router["frontend.checkout.cart.page"],data:{},handler:this.getCheckoutData.bind(this),addItem:this.addItemToCart.bind(this),submit:this.submitCart.bind(this),init:function(){},showAfterSalesModal:!1},infos:{handler:this.getShopInfos.bind(this)},stock:{handler:this.getStockInfos.bind(this)}}}}),e.next=3,ShirtnetworkClient.init(t);case 3:(this.instance=e.sent).$store.dispatch("observe",{event:"navigate",callback:this.navigate.bind(this)}),setTimeout((function(){return a.a.remove()}),1500);case 6:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"addItemToCart",value:(x=y(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cartItems.push({type:"product",referencedId:r.oxid,quantity:Number.parseInt(r.amount),payload:{shirtnetwork:t}});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return x.apply(this,arguments)})},{key:"getShopInfos",value:(S=y(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProduct(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"getStockInfos",value:(v=y(regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.resolveSku(t.psku,t.vsku,t.ssku))){e.next=12;break}return e.t0=JSON,e.next=5,this.client.post("/store-api/product",JSON.stringify({associations:{children:{}},filter:[{type:"equals",field:"children.productNumber",value:n}]}),!0);case 5:if(e.t1=e.sent,!(r=e.t0.parse.call(e.t0,e.t1)).elements.length){e.next=12;break}return i=r.elements[0],o=i.children,a=o.map((function(e){return{size:e.extensions.shirtnetwork.sku.sartnr,variant:e.extensions.shirtnetwork.sku.vartnr,stock:e.isCloseout?e.availableStock:999999}})),e.abrupt("return",a);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"getCheckoutData",value:(h=y(regeneratorRuntime.mark((function e(t){var n,r,i,o,a,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProduct(t);case 2:if(n=e.sent,r=void 0,!t.sskus){e.next=34;break}r=[],i=!0,o=!1,a=void 0,e.prev=9,s=t.sskus[Symbol.iterator]();case 11:if(i=(u=s.next()).done){e.next=20;break}return c=u.value,e.next=15,this.getProduct(d({},t,{ssku:c.sku}));case 15:(l=e.sent)&&r.push({oxid:l.id,id:l.id,amount:c.amount,size:c.size});case 17:i=!0,e.next=11;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(9),o=!0,a=e.t0;case 26:e.prev=26,e.prev=27,i||null==s.return||s.return();case 29:if(e.prev=29,!o){e.next=32;break}throw a;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",{aid:n?n.id:void 0,sizes:r.length?r:void 0});case 35:case"end":return e.stop()}}),e,this,[[9,22,26,34],[27,,29,33]])}))),function(e){return h.apply(this,arguments)})},{key:"getProduct",value:(c=y(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.resolveSku(t.psku,t.vsku,t.ssku))){e.next=14;break}if(!this.cache[n]){e.next=4;break}return e.abrupt("return",this.cache[n]);case 4:return e.t0=JSON,e.next=7,this.client.post("/store-api/product",JSON.stringify({filter:[{type:"equals",field:"productNumber",value:this.resolveSku(t.psku,t.vsku,t.ssku)}]}),!0);case 7:return e.t1=e.sent,r=e.t0.parse.call(e.t0,e.t1),console.log("after getProduct",r),this.cache[n]=r.elements&&r.elements.length?r.elements[0]:{},e.abrupt("return",this.cache[n]);case 14:return e.abrupt("return",{});case 15:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"submitCart",value:(u=y(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.post("/shirtnetwork/add-to-cart",JSON.stringify({lineItems:this.cartItems}));case 2:return t=e.sent,this.cartItems=[],this.instance.$store.dispatch("setIsNavigatingToCart",!0),this.openOffCanvas(),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"navigate",value:function(e){this.pages[e]&&(a.a.create(),this._httpClient.get(this.pages[e],(function(e){a.a.remove(),new i.a(e).open()})))}},{key:"openOffCanvas",value:function(){var e=window.PluginManager.getPluginInstances("OffCanvasCart"),t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.openOffCanvas(window.router["frontend.cart.offcanvas"],!1)}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"resolveSku",value:function(e,t,n){return this.skuScheme.replace("{PRODUCT_SKU}",e).replace("{VARIANT_SKU}",t).replace("{SIZE_SKU}",n)}}])&&b(n.prototype,r),s&&b(n,s),t}(r.a);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}P={version:"1.6.4"},(x="options")in(S=O)?Object.defineProperty(S,x,{value:P,enumerable:!0,configurable:!0,writable:!0}):S[x]=P;var N=function(e){function t(){return C(this,t),j(this,T(t).apply(this,arguments))}var n,r,i,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){document.body.addEventListener("designerBooted",this.designerBooted.bind(this))}},{key:"designerBooted",value:function(e){var t=this;this._httpClient=new o.a,this.instance=e.detail,this.instance.$store.watch((function(e,t){return t.localVars}),(function(){return t.reloadDescription()}),{deep:!0})}},{key:"reloadDescription",value:(a=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.instance.$store.getters.localVar("shopProductInfos"),console.log("reloadDescription",t.id),t&&t.translated?(document.getElementById("designer-description-description-content").innerHTML=t.translated.description,this._httpClient.get("/product/".concat(t.id,"/reviews"),(function(e){document.getElementById("designer-description-reviews-content").innerHTML=e,window.PluginManager.initializePlugins()}))):(document.getElementById("designer-description-description-content").innerHTML="",document.getElementById("designer-description-reviews-content").innerHTML="");case 3:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=a.apply(e,t);function o(e){_(i,n,r,o,s,"next",e)}function s(e){_(i,n,r,o,s,"throw",e)}o(void 0)}))},function(){return s.apply(this,arguments)})}])&&I(n.prototype,r),i&&I(n,i),t}(r.a),D=window.PluginManager;D.register("ShirtnetworkPlugin",O,"[data-shirtnetwork-plugin]"),D.register("ShirtnetworkDescriptionPlugin",N,"[data-shirtnetwork-description-plugin]")}},[["xwCF","runtime","vendor-node","vendor-shared"]]]);