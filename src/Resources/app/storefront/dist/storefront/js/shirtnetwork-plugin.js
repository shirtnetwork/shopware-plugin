(window.webpackJsonp=window.webpackJsonp||[]).push([["shirtnetwork-plugin"],{"7s8A":function(t,e,n){"use strict";n.r(e);var r=n("FGIj"),i=n("Cxgn"),o=n("2Jwc"),a=n("k8s9"),s=n("3xtq"),u=n("p4AR");function c(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){c(o,r,i,a,s,"next",t)}function s(t){c(o,r,i,a,s,"throw",t)}a(void 0)}))}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.client=new u.a}var e,n,r,i,o;return e=t,(n=[{key:"post",value:(o=l(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toPromise(this.client.post(e,n,this.callback));case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"get",value:(i=l(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.toPromise(this.client.get(e,this.callback)));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"toPromise",value:function(t){return new Promise((function(e,n){t.onreadystatechange=function(){4===t.readyState&&(t.status>=200&&t.status<300?e(t.responseText):n({status:t.status,statusText:t.statusText}))}}))}},{key:"callback",value:function(){}}])&&p(e.prototype,n),r&&p(e,r),t}(),h=function(t){return new Promise((function(e,n){var r=document.createElement("script");r.src=t,r.async=!0,r.onerror=n,r.onload=r.onreadystatechange=function(){var t=this.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,e())},document.head.appendChild(r)}))};function d(t,e){if(null==t)return e;for(var n in e)e[n].constructor===Object?t[n]=d(t[n],e[n]):void 0===t[n]&&(t[n]=e[n]);return t}function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function m(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){m(o,r,i,a,s,"next",t)}function s(t){m(o,r,i,a,s,"throw",t)}a(void 0)}))}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O,P,_,R=function(t){function e(){return g(this,e),w(this,S(e).apply(this,arguments))}var n,r,u,c,l,p,v,m,O,P;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(e,t),n=e,(r=[{key:"init",value:function(){var t=this;s.a.create(),this._httpClient=new a.a,this.client=new f,this.cartItems=[],this.cache={},this.skuScheme=this.options.skuScheme||"{PRODUCT_SKU}-{VARIANT_SKU}-{SIZE_SKU}",this.pages=this.options.pages||{},h("//cdn.shirtnetwork.de/client/shirtnetwork-client.js").then((function(){return t.boot()}))}},{key:"boot",value:(P=b(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=d(this.options,{settings:{container:this.el.id,shop:{cart:{link:window.router["frontend.checkout.cart.page"],data:{},handler:this.getCheckoutData.bind(this),addItem:this.addItemToCart.bind(this),submit:this.submitCart.bind(this),init:function(){},showAfterSalesModal:!1},infos:{handler:this.getShopInfos.bind(this)},stock:{handler:this.getStockInfos.bind(this)}}}}),t.next=3,ShirtnetworkClient.init(e);case 3:t.sent.$store.dispatch("observe",{event:"navigate",callback:this.navigate.bind(this)}),setTimeout((function(){return s.a.remove()}),1500);case 6:case"end":return t.stop()}}),t,this)}))),function(){return P.apply(this,arguments)})},{key:"addItemToCart",value:(O=b(regeneratorRuntime.mark((function t(e,n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.cartItems.push({type:"product",referencedId:r.oxid,quantity:Number.parseInt(r.amount),payload:{shirtnetwork:e}});case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return O.apply(this,arguments)})},{key:"getShopInfos",value:(m=b(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getProduct(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"getStockInfos",value:(v=b(regeneratorRuntime.mark((function t(e){var n,r,i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.resolveSku(e.psku,e.vsku,e.ssku))){t.next=12;break}return t.t0=JSON,t.next=5,this.client.post("/store-api/product",JSON.stringify({associations:{children:{}},includes:{product:["children","id","productNumber","availableStock","extensions","shirtnetwork_sku"]},filter:[{type:"equals",field:"children.productNumber",value:n}]}),!0);case 5:if(t.t1=t.sent,!(r=t.t0.parse.call(t.t0,t.t1)).elements.length){t.next=12;break}return i=r.elements[0],o=i.children,a=o.map((function(t){return{size:t.extensions.shirtnetwork_sku.sartnr,variant:t.extensions.shirtnetwork_sku.vartnr,stock:t.availableStock}})),t.abrupt("return",a);case 12:return t.abrupt("return",[]);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"getCheckoutData",value:(p=b(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getProduct(e);case 2:if(n=t.sent,r=void 0,!e.sskus){t.next=34;break}r=[],i=!0,o=!1,a=void 0,t.prev=9,s=e.sskus[Symbol.iterator]();case 11:if(i=(u=s.next()).done){t.next=20;break}return c=u.value,t.next=15,this.getProduct(y({},e,{ssku:c.sku}));case 15:(l=t.sent)&&r.push({oxid:l.id,id:l.id,amount:c.amount,size:c.size});case 17:i=!0,t.next=11;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(9),o=!0,a=t.t0;case 26:t.prev=26,t.prev=27,i||null==s.return||s.return();case 29:if(t.prev=29,!o){t.next=32;break}throw a;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return t.abrupt("return",{aid:n?n.id:void 0,sizes:r.length?r:void 0});case 35:case"end":return t.stop()}}),t,this,[[9,22,26,34],[27,,29,33]])}))),function(t){return p.apply(this,arguments)})},{key:"getProduct",value:(l=b(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.resolveSku(e.psku,e.vsku,e.ssku))){t.next=14;break}if(!this.cache[n]){t.next=4;break}return t.abrupt("return",this.cache[n]);case 4:return t.t0=JSON,t.next=7,this.client.post("/store-api/product",JSON.stringify({filter:[{type:"equals",field:"productNumber",value:this.resolveSku(e.psku,e.vsku,e.ssku)}]}),!0);case 7:return t.t1=t.sent,r=t.t0.parse.call(t.t0,t.t1),console.log("after getProduct",r),this.cache[n]=r.elements&&r.elements.length?r.elements[0]:{},t.abrupt("return",this.cache[n]);case 14:return t.abrupt("return",{});case 15:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"submitCart",value:(c=b(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.post("/store-api/checkout/cart/line-item",JSON.stringify({items:this.cartItems}));case 2:return e=t.sent,this.cartItems=[],this.openOffCanvas(),t.abrupt("return",e);case 6:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"navigate",value:function(t){this.pages[t]&&(s.a.create(),this._httpClient.get(this.pages[t],(function(t){s.a.remove(),new o.a(t).open()})))}},{key:"openOffCanvas",value:function(){var t=i.a.getPluginInstances("OffCanvasCart"),e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)o.value.openOffCanvas(window.router["frontend.cart.offcanvas"],!1)}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"resolveSku",value:function(t,e,n){return this.skuScheme.replace("{PRODUCT_SKU}",t).replace("{VARIANT_SKU}",e).replace("{SIZE_SKU}",n)}}])&&k(n.prototype,r),u&&k(n,u),e}(r.a);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function E(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}_={version:"1.6.4"},(P="options")in(O=R)?Object.defineProperty(O,P,{value:_,enumerable:!0,configurable:!0,writable:!0}):O[P]=_;var D=function(t){function e(){return j(this,e),E(this,N(e).apply(this,arguments))}var n,r,o,s,u;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(e,t),n=e,(r=[{key:"init",value:function(){document.body.addEventListener("designerBooted",this.designerBooted.bind(this))}},{key:"designerBooted",value:function(t){var e=this;this._httpClient=new a.a,this.instance=t.detail,this.instance.$store.watch((function(t,e){return e.localVars}),(function(){return e.reloadDescription()}),{deep:!0})}},{key:"reloadDescription",value:(s=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.instance.$store.getters.localVar("shopProductInfos"),console.log("reloadDescription",e.id),e&&e.translated?(document.getElementById("designer-description-description-content").innerHTML=e.translated.description,this._httpClient.get("/product/".concat(e.id,"/reviews"),(function(t){document.getElementById("designer-description-reviews-content").innerHTML=t,i.a.initializePlugins()}))):(document.getElementById("designer-description-description-content").innerHTML="",document.getElementById("designer-description-reviews-content").innerHTML="");case 3:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=s.apply(t,e);function o(t){C(i,n,r,o,a,"next",t)}function a(t){C(i,n,r,o,a,"throw",t)}o(void 0)}))},function(){return u.apply(this,arguments)})}])&&T(n.prototype,r),o&&T(n,o),e}(r.a),J=window.PluginManager;J.register("ShirtnetworkPlugin",R,"[data-shirtnetwork-plugin]"),J.register("ShirtnetworkDescriptionPlugin",D,"[data-shirtnetwork-description-plugin]")}},[["7s8A","runtime","vendor-node","vendor-shared"]]]);